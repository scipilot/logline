$.pluginMaker=function(t){$.fn[t.prototype.name]=function(e){var i=$.makeArray(arguments),s=i.slice(1);return this.each(function(){var n=$.data(this,t.prototype.name);n?"string"==typeof e?n[e].apply(n,s):n.update&&n.update.apply(n,i):(p=new t(this,e),$.data(this,p.name,p),p.element=$(this),p.element.addClass(p.name))})}},function(t){var e=function(t,e){this.settings={},t&&this.init(t,e)};t.extend(e.prototype,{name:"scipilot_logline",timeline:null,dsItems:null,dsGroups:null,aFamilies:[],aLogGroups:{},aLogGroupIndex:[],aGroupTitles:{},aCssClassMap:{},timelineOptions:{},defaults:{API:{URL:""},unitId:null,since:"",until:"",CSS:{loading:"loading",loader:"loader"},dataProviders:[],format:function(t,e){var i=t.logGroupField?e[t.logGroupField]:"",s=e[t.titleField];return{content:s,className:t.cssClassMap[i]}}},seriesLoaded:0,onDataLoadedDefault:function(){this.log("All data loaded!")},init:function(e,i){this.defaults.onDataLoaded=t.proxy(this.onDataLoadedDefault,this),i&&(this.settings=t.extend({},this.defaults),t.extend(this.settings,i)),this.timelineOptions={maxHeight:window.innerHeight,stack:!1,zoomMin:1e3,zoomMax:1e11,min:this.settings.since,max:this.settings.until}},indexGroup:function(e){e.logGroups&&t.each(e.logGroups,t.proxy(function(t,i){var s=e.family+"."+i;this.dsGroups.add({id:s,content:e.groupTitles[i],order:this.aLogGroupIndex.length}),this.aLogGroupIndex[s]=this.dsGroups.length},this))},log:function(t){"undefined"!=typeof console?console.log.apply(console,arguments):this.log+=t+"\n"},setAPIURL:function(t){this.settings.API.URL=t},load:function(){this.dsItems=new vis.DataSet,this.dsGroups=new vis.DataSet,this.timeline=new vis.Timeline(this.element.get(0),this.dsItems,this.dsGroups,this.timelineOptions),this.seriesLoaded=0,t.each(this.settings.dataProviders,t.proxy(function(t,e){this.loadInjectedData(e,this.settings.dataProviders.length,t+1)},this))},injectMetaData:function(t){t.logGroups=t.logGroups?t.logGroups:[""],this.indexGroup(t)},loadInjectedData:function(e,i,s){var n=t('<div class="'+this.settings.CSS.loading+'">Loading data from source '+s+"/"+i+"...</div>").prependTo(t("."+this.settings.CSS.loader));e(this.settings.unitId,this.settings.since,this.settings.until,t.proxy(function(t,e){"success"==t?(this.injectMetaData(e.meta),this.processLogs(e.data,e.meta)):alert("Sorry, the "+e.meta.apiNoun+" data failed to load. ("+t+")"),n.remove(),++this.seriesLoaded==i&&this.settings.onDataLoaded()},this))},processLogs:function(e,i){var s,n,o,a={},l=1,d=null,r=null;for(s=0;s<e.length;s++)n=e[s],o=this.getVisGroup(i.family,n[i.logGroupField]),d=null,r=null,i.rangedLogs&&i.rangedLogs.indexOf(n[i.logGroupField])!=-1?1==n[i.stateField]?(a[n[i.logGroupField]]&&(r=a[n[i.logGroupField]][i.dateField],d=n[i.dateField],this.addVisItem(i,n,r,d,null),this.log("Timeline warning: A stateful log with no end was detected and closed off. Perhaps a missing end-log? ",n)),a[n[i.logGroupField]]=n):(d=n[i.dateField],a[n[i.logGroupField]]?(r=a[n[i.logGroupField]][i.dateField],a[n[i.logGroupField]]=null):r=this.settings.since,this.addVisItem(i,n,r,d,null)):(i.endDateField&&n[i.endDateField]&&(d=n[i.endDateField]),this.addVisItem(i,n,null,d,l++));d=this.settings.until,t.each(a,t.proxy(function(t,e){e&&this.addVisItem(i,e,null,d,null)},this)),this.timeline.fit(!1),i.onTimelineUpdated&&i.onTimelineUpdated()},addVisItem:function(t,e,i,s,n){var o,a="box",l=this.getVisGroup(t.family,e[t.logGroupField]),d=this.settings.format(t,e);o={id:t.family+e.logId,group:l,start:i?i:e[t.dateField],content:d.content,className:d.className?d.className:"",style:d.style?d.style:null},t.stack&&(o.subgroup=n),s&&(o.end=s,a="range"),o.type=d.type?d.type:a,this.dsItems.add(o)},getVisGroup:function(t,e){var i=t+"."+e;return this.aLogGroupIndex.hasOwnProperty(i)?i:t+"."}}),t.pluginMaker(e)}(jQuery);